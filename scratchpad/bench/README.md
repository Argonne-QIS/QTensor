## Benchmarking memory usage of different backends

This script is effectively a proxy for simulating large quantum circuits.
Most of the expensive contractions have the form that is generated by this script.

### Requirements

	» cat requirements.txt
	opt_einsum
	pyrofiler
	fire

### Usage


    $ python einsum.py --help

    NAME
        einsum.py - Performs a contraction that does not include hard optimization task. Majority of indices are in ``d`` tensors, and other ``s`` tensors are small

    SYNOPSIS
        einsum.py K <flags>

    DESCRIPTION
        Performs a contraction that does not include hard optimization task. Majority of indices are in ``d`` tensors, and other ``s`` tensors are small

    POSITIONAL ARGUMENTS
        K
            total number of indices in result

    FLAGS
        --C=C
            contracted indices
        --d=D
            number of dominating tensors
        --s=S
            number of small tensors
        --backend=BACKEND
        --seed=SEED

    NOTES
        You can also use flags syntax for POSITIONAL ARGUMENTS


### Example

	» python einsum.py 23 --backend=opt_einsum --C 5 -d 3 -s 10

	Overhead: 53858304
	Should take: 67108864 Bytes
	Total expected Memory: 120967168 Bytes
	large sizes [12, 12, 16]
	contraction: cdaebBqjhsyf,cdaebpmuktox,cdaebizzrvgnlwAu,dbilh,a,dskfo,bj,bB,ccl,ap,a,dcx,bj->uzjqkfhrmlwAByinvxgotsp
	Contracting 13 tensors
	optimization time : 0.0034983158111572266
	Largest memory 67108864
	time to contract: : 2.386263132095337
	Done
	memory to contract : 140021760

### Better quality memory measurements

Linux has cgroups option that allows for more accurate memory measurement.

Use [benchexec](https://github.com/sosy-lab/benchexec) to run benchmarks.

To run thing that should scale no more than 2^20 elements:

`runexec --read-only-dir / -- python einsum.py 20`


To measure overhead: 

`runexec --read-only-dir / -- python einsum.py 0`
